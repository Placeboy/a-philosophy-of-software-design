# 5.3 时间分解

信息泄露的一个常见原因是一种我称之为时间分解的设计风格。在时间分解中，一个系统的结构与操作发生的时间顺序相对应。考虑一个应用程序，它读取一个特定格式的文件，修改文件的内容，然后再把文件写出来。通过时间分解，这个应用程序可能被分成三类：一类是读取文件，另一类是执行修改，第三类是写出新版本。文件读取和文件写入步骤都有关于文件格式的知识，这导致了信息泄露。解决方案是将读写文件的核心机制合并为一个单一的类。这个类将在应用程序的读和写阶段被使用。陷入时间分解的陷阱是很容易的，因为当你编码时，操作必须发生的顺序往往在你的脑海中。然而，大多数的设计决定在应用程序的生命周期中会在几个不同的时间段表现出来；因此，时间分解往往会导致信息泄露。

顺序通常是重要的，所以它会反映在应用程序的某个地方。然而，它不应该反映在模块结构中，除非该结构与信息隐藏一致（也许不同的阶段使用完全不同的信息）。在设计模块时，要关注执行每个任务所需的知识，而不是任务发生的顺序。

{% hint style="danger" %}
危险信号：时间上的分解

在时间分解中，执行顺序反映在代码结构中：发生在不同时间的操作在不同的方法或类中。如果相同的知识在执行的不同时间点被使用，它就会被编码在多个地方，导致信息泄露。
{% endhint %}
